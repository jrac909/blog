<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>app.use([path], function) | Jrac&#39;s å‰ç«¯æŠ€æœ¯æ–‡æ¡£</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="imgs/home_home.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/blog/assets/css/0.styles.dab10465.css" as="style"><link rel="preload" href="/blog/assets/js/app.d0cd04c6.js" as="script"><link rel="preload" href="/blog/assets/js/2.ab3d18b3.js" as="script"><link rel="preload" href="/blog/assets/js/42.af93135d.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.da15c793.js"><link rel="prefetch" href="/blog/assets/js/11.73da7b41.js"><link rel="prefetch" href="/blog/assets/js/12.4508db17.js"><link rel="prefetch" href="/blog/assets/js/13.e094c783.js"><link rel="prefetch" href="/blog/assets/js/14.d3441cb2.js"><link rel="prefetch" href="/blog/assets/js/15.ba762ceb.js"><link rel="prefetch" href="/blog/assets/js/16.c7c5cfb4.js"><link rel="prefetch" href="/blog/assets/js/17.589e1ac9.js"><link rel="prefetch" href="/blog/assets/js/18.74587141.js"><link rel="prefetch" href="/blog/assets/js/19.f6d88dc2.js"><link rel="prefetch" href="/blog/assets/js/20.55e5cb60.js"><link rel="prefetch" href="/blog/assets/js/21.916144e2.js"><link rel="prefetch" href="/blog/assets/js/22.8a05f14c.js"><link rel="prefetch" href="/blog/assets/js/23.3018200b.js"><link rel="prefetch" href="/blog/assets/js/24.e0e1af30.js"><link rel="prefetch" href="/blog/assets/js/25.0d24b0a7.js"><link rel="prefetch" href="/blog/assets/js/26.0c212d54.js"><link rel="prefetch" href="/blog/assets/js/27.54051f7c.js"><link rel="prefetch" href="/blog/assets/js/28.f142ed8f.js"><link rel="prefetch" href="/blog/assets/js/29.2ddf620c.js"><link rel="prefetch" href="/blog/assets/js/3.23f380c7.js"><link rel="prefetch" href="/blog/assets/js/30.df4f6778.js"><link rel="prefetch" href="/blog/assets/js/31.73afca0c.js"><link rel="prefetch" href="/blog/assets/js/32.48b9c904.js"><link rel="prefetch" href="/blog/assets/js/33.6c36ae22.js"><link rel="prefetch" href="/blog/assets/js/34.b94eff51.js"><link rel="prefetch" href="/blog/assets/js/35.2aaeee54.js"><link rel="prefetch" href="/blog/assets/js/36.1c4ead70.js"><link rel="prefetch" href="/blog/assets/js/37.d9f94543.js"><link rel="prefetch" href="/blog/assets/js/38.3e816bea.js"><link rel="prefetch" href="/blog/assets/js/39.81b702e1.js"><link rel="prefetch" href="/blog/assets/js/4.987baa04.js"><link rel="prefetch" href="/blog/assets/js/40.015849cd.js"><link rel="prefetch" href="/blog/assets/js/41.5567f825.js"><link rel="prefetch" href="/blog/assets/js/43.d964714b.js"><link rel="prefetch" href="/blog/assets/js/44.7e634282.js"><link rel="prefetch" href="/blog/assets/js/45.579e1b4f.js"><link rel="prefetch" href="/blog/assets/js/46.42996734.js"><link rel="prefetch" href="/blog/assets/js/47.10fe0064.js"><link rel="prefetch" href="/blog/assets/js/48.b1f0198b.js"><link rel="prefetch" href="/blog/assets/js/49.89b8323f.js"><link rel="prefetch" href="/blog/assets/js/5.d250cb53.js"><link rel="prefetch" href="/blog/assets/js/6.d7e152ce.js"><link rel="prefetch" href="/blog/assets/js/7.184419e9.js"><link rel="prefetch" href="/blog/assets/js/8.af0d9068.js"><link rel="prefetch" href="/blog/assets/js/9.083baca9.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.dab10465.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Jrac's å‰ç«¯æŠ€æœ¯æ–‡æ¡£</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/interview/question/01.html" class="nav-link">
  é¢è¯•ç›¸å…³
</a></div><div class="nav-item"><a href="/blog/cicd/docker/DockerFile.html" class="nav-link">
  CICD
</a></div><div class="nav-item"><a href="/blog/basic/js/modularity.html" class="nav-link">
  Basic
</a></div><div class="nav-item"><a href="/blog/UI/elementui/main.html" class="nav-link">
  UI
</a></div><div class="nav-item"><a href="/blog/server/node/node_basic.html" class="nav-link">
  Server
</a></div><div class="nav-item"><a href="/blog/framework/vue/ssr.html" class="nav-link">
  Framework
</a></div><div class="nav-item"><a href="/blog/else/monorepo/main.html" class="nav-link">
  Else
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/interview/question/01.html" class="nav-link">
  é¢è¯•ç›¸å…³
</a></div><div class="nav-item"><a href="/blog/cicd/docker/DockerFile.html" class="nav-link">
  CICD
</a></div><div class="nav-item"><a href="/blog/basic/js/modularity.html" class="nav-link">
  Basic
</a></div><div class="nav-item"><a href="/blog/UI/elementui/main.html" class="nav-link">
  UI
</a></div><div class="nav-item"><a href="/blog/server/node/node_basic.html" class="nav-link">
  Server
</a></div><div class="nav-item"><a href="/blog/framework/vue/ssr.html" class="nav-link">
  Framework
</a></div><div class="nav-item"><a href="/blog/else/monorepo/main.html" class="nav-link">
  Else
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Node</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/server/node/node_basic.html" class="sidebar-link">Node é—®é¢˜æ±‡æ€»</a></li><li><a href="/blog/server/node/node_api.html" class="sidebar-link">Node Api</a></li><li><a href="/blog/server/node/express.html" aria-current="page" class="active sidebar-link">Express</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/server/node/express.html#app-use-path-function" class="sidebar-link">app.use([path], function)</a></li><li class="sidebar-sub-header"><a href="/blog/server/node/express.html#express-static-root-options" class="sidebar-link">express.static(root, [options])</a></li></ul></li><li><a href="/blog/server/node/yarn.html" class="sidebar-link">Yarn</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Pm2</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Script</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nginx</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="app-use-path-function"><a href="#app-use-path-function" class="header-anchor">#</a> app.use([path], function)</h2> <p><strong>express æ˜¯ä¸€ä¸ªè·¯ç”±å’Œä¸­é—´ä»¶ Web æ¡†æ¶</strong>ï¼Œè¿™ä¸ªæ¡†æ¶è‡ªèº«çš„åŠŸèƒ½å¾ˆå°‘ï¼Œå®ƒä¸»è¦æ˜¯ç”¨æ¥è°ƒç”¨ä¸€ç³»åˆ—ä¸­é—´ä»¶å‡½æ•°ï¼Œä¸­é—´ä»¶å‡½æ•°åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p> <p><strong>ä¸­é—´ä»¶å‡½æ•°</strong>ç›´æ¥ä»ä»£ç æ¥ç†è§£ï¼Œå®ƒè¢« express æ‰§è¡Œï¼Œå…¶å®å°±æ˜¯ä½œä¸ºå‚æ•°ä¼ é€’ç»™ app.use å‡½æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªä¸­é—´ä»¶å‡½æ•°å‚æ•°æœ‰<code>(req, res, next) =&gt; {}</code>,ç”±æ­¤å¯çŸ¥ï¼Œè¿™ä¸ªä¸­é—´ä»¶å‡½æ•°æ˜¯å¯ä»¥è®¿é—®è¯·æ±‚å¯¹è±¡(req)ã€å“åº”å¯¹è±¡(res)ä»¥åŠä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°(next)çš„ã€‚å¬æè¿°æœ‰ç‚¹åƒæ‹¦æˆªå™¨ã€‚å®ƒæœ‰ä»¥ä¸‹é‡è¦ç‰¹æ€§ï¼š</p> <ul><li>æ›´æ”¹è¯·æ±‚å’Œå“åº”å¯¹è±¡(æ¯”å¦‚ res.setHeaderç­‰ç­‰)</li> <li>ç»“æŸè¯·æ±‚å“åº”å‘¨æœŸ(res.end())</li> <li>è°ƒç”¨å †æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°(next())</li></ul> <div class="custom-block danger"><p class="custom-block-title">æ³¨æ„</p> <p>å…³äº <code>ç»“æŸè¯·æ±‚å“åº”å‘¨æœŸ(res.end())</code>ï¼Œå¦‚æœæ­¤æ—¶è¿›æ¥ä¸€ä¸ªè¯·æ±‚ï¼ŒæŸä¸ªä¸­é—´ä»¶å‡½æ•°åŒ¹é…äº†è¿™ä¸ªè¯·æ±‚ï¼Œæ‰§è¡Œè¿™ä¸ªä¸­é—´å‡½æ•°ï¼Œåœ¨è¿™ä¸ªä¸­é—´å‡½æ•°çš„ç»“æŸå¯ä»¥åšä¸¤ç§å¤„ç†ï¼š1. ä½¿ç”¨ res.end() ç»“æŸå½“å‰è¯·æ±‚ï¼Œè¿™æ ·çš„è¯ï¼Œå…¶ä»–åŒ¹é…è¯¥è¯·æ±‚çš„ä¸­é—´å‡½æ•°å°±ä¸ä¼šå†æ‰§è¡Œï¼›2. è°ƒç”¨ next() æŠŠè¯·æ±‚çš„æ§åˆ¶æƒé™äº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ã€‚é™¤äº†è¿™ä¸¤ç§å¤„ç†ï¼Œè¯·æ±‚éƒ½å°†è¢«æŒ‚èµ·ã€‚</p></div> <p><strong>ä¸­é—´ä»¶ç±»å‹</strong></p> <ul><li>åº”ç”¨çº§ä¸­é—´ä»¶</li> <li>è·¯ç”±çº§ä¸­é—´ä»¶</li> <li>é”™è¯¯å¤„ç†ä¸­é—´ä»¶</li> <li>å†…ç½®ä¸­é—´ä»¶</li> <li>ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶</li></ul> <h3 id="åº”ç”¨çº§ä¸­é—´ä»¶"><a href="#åº”ç”¨çº§ä¸­é—´ä»¶" class="header-anchor">#</a> åº”ç”¨çº§ä¸­é—´ä»¶</h3> <p>ä¸è®¾ç½® pathï¼Œæ¯æ¬¡åº”ç”¨è¯·æ±‚æ—¶éƒ½ä¼šæ‰§è¡Œè¯¥å‡½æ•°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è®¾ç½® pathï¼Œä¸æŒ‡å®š methodï¼Œæ¯æ¬¡åº”ç”¨è¯·æ±‚è¯¥ path éƒ½ä¼šæ‰§è¡Œè¯¥å‡½æ•°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>method<span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è®¾ç½® path å’Œ methodï¼Œåªæœ‰è¯·æ±‚æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶æ‰æ‰§è¡Œè¯¥å‡½æ•°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'USER'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>é’ˆå¯¹æŸä¸€ä¸ªè·¯ç”±ï¼Œä¹Ÿå°±æ˜¯æŸä¸€ä¸ª pathï¼Œå¯ä»¥æœ‰å¤šä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œå½¢æˆä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°é˜Ÿåˆ—ï¼Œè¿™äº›ä¸­é—´ä»¶å‡½æ•°éµå¾ªä»¥ä¸‹è§„åˆ™</strong></p> <ul><li>å¿…é¡»æ‰§è¡Œ next() æ‰èƒ½å°†æ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œå¦åˆ™ä¸ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°</li> <li>ä¸­é—´ä»¶å‡½æ•°é˜Ÿåˆ—ä¸­æ‰€æœ‰å‡½æ•°ï¼Œåªèƒ½æ‰§è¡Œä¸€æ¬¡ res.send(); å¹¶ä¸”å† res.send() åå°±ä¸èƒ½æ‰§è¡Œnext() äº†,æ€»ä¹‹éœ€è¦è®°ä½,å› ä¸ºæ‰€æœ‰çš„ä¸­é—´ä»¶å‡½æ•°éƒ½èƒ½æ“ä½œ reqã€resï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¿è¯ res.send() æ˜¯å¯¹ reqã€res çš„æœ€åæ“ä½œï¼Œæ‰€ä»¥ next() ä¸å…è®¸åœ¨ res.send() åé¢ã€‚</li> <li>å¤šä¸ªä¸­é—´ä»¶å‡½æ•°å¯ä»¥å†™åšå¤šä¸ª app.useï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå¤šä¸ªå‚æ•°ä¼ é€’ç»™ä¸€ä¸ª app.use</li></ul> <p><strong>ğŸ’¥ Case 1</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è®¿é—® /user/333, è¾“å‡ºæ˜¯ Req URL: /user/333 Req Type: GET Req URL2: /user/333</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Req URL: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> req<span class="token punctuation">.</span>originalUrl <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Req URL2: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> req<span class="token punctuation">.</span>originalUrl <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Req URL: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> req<span class="token punctuation">.</span>originalUrl <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Req Type: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> req<span class="token punctuation">.</span>method <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>ğŸ’¥ Case 2</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æ‰§è¡Œç»“æœç›¸åŒ</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Req URL: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> req<span class="token punctuation">.</span>originalUrl <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Req URL2: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> req<span class="token punctuation">.</span>originalUrl <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Req URL: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> req<span class="token punctuation">.</span>originalUrl <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Req Type: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> req<span class="token punctuation">.</span>method <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="è·¯ç”±å™¨ä¸­é—´ä»¶"><a href="#è·¯ç”±å™¨ä¸­é—´ä»¶" class="header-anchor">#</a> è·¯ç”±å™¨ä¸­é—´ä»¶</h3> <p>å’Œåº”ç”¨çº§çš„å·¥ä½œæ–¹å¼åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯è¯´åˆ›å»ºæ–¹å¼ä¸åŒï¼Œå¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŒæ ·ä½¿ç”¨ router.use å’Œ router.Method æ–¹æ³•</p> <h3 id="é”™è¯¯å¤„ç†ä¸­é—´ä»¶"><a href="#é”™è¯¯å¤„ç†ä¸­é—´ä»¶" class="header-anchor">#</a> é”™è¯¯å¤„ç†ä¸­é—´ä»¶</h3> <div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>é”™è¯¯ä¸­é—´ä»¶å‡½æ•°æœ‰å››ä¸ªå‚æ•°<code>(err, req, res, next) =&gt; {}</code>ï¼Œå¹¶ä¸”æ¡†æ¶æ˜¯é€šè¿‡å‚æ•°ä¸ªæ•°æ¥åˆ¤æ–­æ˜¯å¦æ˜¯é”™è¯¯ä¸­é—´ä»¶çš„ï¼Œæ‰€ä»¥å³ä½¿ä¸ç”¨ next å‚æ•°, ä¹Ÿå¿…é¡»è¦å†™å‡ºæ¥ã€‚</p></div> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>stack<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'error!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å†…ç½®ä¸­é—´ä»¶"><a href="#å†…ç½®ä¸­é—´ä»¶" class="header-anchor">#</a> å†…ç½®ä¸­é—´ä»¶</h3> <p>express ä¸­å”¯ä¸€å†…ç½®çš„ä¸­é—´ä»¶å‡½æ•°æ˜¯ express.staticï¼Œè´Ÿè´£æä¾› express åº”ç”¨ç¨‹åºçš„é™æ€èµ„æºã€‚è¯¦ç»†ä½¿ç”¨è§å·¦ä¾§ç›®å½• <code>express.static(root, [options])</code></p> <h3 id="ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶"><a href="#ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶" class="header-anchor">#</a> ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶</h3> <p>è¿™ä¸ªå°±ç›´æ¥å®‰è£…ã€å¼•å…¥ã€ä½¿ç”¨å°±å¥½äº†ã€‚æ¯”å¦‚ï¼š<code>serve-favicon</code>ï¼ŒåŠŸèƒ½æ¯”è¾ƒå•ä¸€ç®€å•ï¼Œå¯ä»¥çœ‹çœ‹æºç ï¼Œå…¶å®æœ¬è´¨å°±æ˜¯è¿”å›äº†ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ã€‚</p> <h2 id="express-static-root-options"><a href="#express-static-root-options" class="header-anchor">#</a> express.static(root, [options])</h2> <p><strong>æœ€ç®€å•çš„ä½¿ç”¨</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>æ ¹æ®ä¸Šè¿°ä½¿ç”¨æ–¹å¼ï¼Œæ¥è®²ä¸€è®²å®ƒçš„ä½œç”¨</strong></p> <p>é¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“ app.use çš„å‚æ•°æ˜¯ä¸­é—´ä»¶å‡½æ•°ï¼Œä¸­é—´ä»¶å‡½æ•°çš„ä½œç”¨æ˜¯æ‹¦æˆª path, æ“ä½œ req, res ç­‰ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ª root, ä¹Ÿå°±æ˜¯ä¸€ä¸ªæ ¹è·¯å¾„ä¸‹çš„æ–‡ä»¶å¤¹åå­—ï¼Œæ¯”å¦‚æœ‰é¡¹ç›® demoï¼Œdemo ä¸‹æœ‰æ–‡ä»¶å¤¹ publicï¼Œå…¶ä¸­å­˜æ”¾äº†å›¾ç‰‡ã€js æ–‡ä»¶ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¦è¯·æ±‚å…¶ä¸­çš„ a.png, æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œæ‹¦æˆª public/a.pngï¼Œæˆ–è€…åšåŒ¹é…ï¼Œç„¶åé€šè¿‡ res è¿”å›ç›¸åº”çš„èµ„æºï¼Œè¿™æ ·å¤„ç†å¾ˆéº»çƒ¦ä½†æ˜¯åˆå¾ˆå›ºå®šï¼Œæ‰€ä»¥å°±å†…ç½®äº†è¿™ä¸ªä¸­é—´ä»¶å‡½æ•°ã€‚</p> <p><strong>options</strong></p> <table><thead><tr><th>å±æ€§</th> <th style="text-align:center;">æè¿°</th> <th style="text-align:right;">ç±»å‹</th> <th style="text-align:center;">é»˜è®¤å€¼</th></tr></thead> <tbody><tr><td>acceptRanges</td> <td style="text-align:center;">æ˜¯å¦å¯ç”¨ Accept-Ranges å’Œ Range è¯·æ±‚å¤´</td> <td style="text-align:right;">boolean</td> <td style="text-align:center;">true</td></tr> <tr><td>cacheControl</td> <td style="text-align:center;">æ˜¯å¦å¯ç”¨ Cache-Control</td> <td style="text-align:right;">boolean</td> <td style="text-align:center;">true</td></tr> <tr><td>dotfiles</td> <td style="text-align:center;">é‡åˆ° . æ–‡ä»¶å¦‚ä½•å¤„ç†(ç›´æ¥ . å¼€å¤´çš„æ–‡ä»¶)</td> <td style="text-align:right;">string</td> <td style="text-align:center;">'ignore'</td></tr> <tr><td>etag</td> <td style="text-align:center;">Enable or disable etag generation</td> <td style="text-align:right;">boolean</td> <td style="text-align:center;">true</td></tr> <tr><td>extensions</td> <td style="text-align:center;">Set file extension fallbacks. When set, if a file is not found, the given extensions will be added to the file name and search for. The first that exists will be served. Example: ['html', 'htm'].</td> <td style="text-align:right;">boolean</td> <td style="text-align:center;">false</td></tr> <tr><td>fallthrough</td> <td style="text-align:center;"></td> <td style="text-align:right;">boolean</td> <td style="text-align:center;">true</td></tr></tbody></table> <p><strong>dotfiles</strong></p> <table><thead><tr><th>å€¼</th> <th style="text-align:center;">å¤„ç†æ–¹å¼</th></tr></thead> <tbody><tr><td>'allow'</td> <td style="text-align:center;">No special treatment for dotfiles.</td></tr> <tr><td>'deny'</td> <td style="text-align:center;">Deny a request for a dotfile and 403/next().</td></tr> <tr><td>dotfiles</td> <td style="text-align:center;">Pretend like the dotfile does not exist and 404/next().</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/blog/server/node/node_api.html" class="prev">
        Node Api
      </a></span> <span class="next"><a href="/blog/server/node/yarn.html">
        Yarn
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.d0cd04c6.js" defer></script><script src="/blog/assets/js/2.ab3d18b3.js" defer></script><script src="/blog/assets/js/42.af93135d.js" defer></script>
  </body>
</html>
